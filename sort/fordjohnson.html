<!DOCTYPE html><html lang="en"><head><title>sort/fordjohnson</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="sort/fordjohnson"><meta name="groc-project-path" content="js/src/sort/fordjohnson.js"><meta name="groc-github-url" content="https://github.com/aureooms/js-selection"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/aureooms/js-selection/blob/master/js/src/sort/fordjohnson.js">js/src/sort/fordjohnson.js</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> _fordjohnson = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> binarysearch </span>) </span>{

	<span class="hljs-keyword">var</span> fordjohnson = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> compare , swap , a , i , j </span>) </span>{

		<span class="hljs-keyword">var</span> m , k , t , y , p , q , r , x , l , w , s , pairswap ;

		<span class="hljs-keyword">if</span> ( j - i &lt; <span class="hljs-number">2</span> ) <span class="hljs-keyword">return</span> ;

		k = m = ( j - i ) / <span class="hljs-number">2</span> | <span class="hljs-number">0</span> ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>compare pairs of elements and put largest elements at the front of the
array</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">while</span> ( k-- ) {

			<span class="hljs-keyword">if</span> ( compare( a[i+k] , a[i+m+k] ) &lt; <span class="hljs-number">0</span> ) {

				swap( a , i + k , i + m + k ) ;

			}

		}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>sort the largest elements at the front recursively</p></div></div><div class="code"><div class="wrapper">		pairswap = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> a , i , j </span>) </span>{
			swap( a , i , j ) ;
			swap( a , i + m , j + m ) ;
		} ;

		fordjohnson( compare , pairswap , a , i , i + m ) ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>merge the rest of the array into the front, one item at a time</p></div></div><div class="code"><div class="wrapper">		p = y = t = <span class="hljs-number">1</span> ;

		q = <span class="hljs-number">0</span> ;

		<span class="hljs-keyword">while</span> ( i + m + t &lt;= j ) {

			r = t ;

			<span class="hljs-keyword">while</span> ( r --&gt; q ) {

				w = a[i+m+t-<span class="hljs-number">1</span>] ;

				x = binarysearch( compare , a , i , i + m + q , w ) ;
				l = x[<span class="hljs-number">0</span>] + x[<span class="hljs-number">1</span>] ;

				s = i + m + t ;

				<span class="hljs-keyword">while</span> ( --s &gt; l ) {

					swap( a , s , s - <span class="hljs-number">1</span> ) ;

				}

			}

			q = t ;

			p *= <span class="hljs-number">2</span> ;
			y = p - <span class="hljs-number">2</span> * t ;
			t += y ;

		}

		r = j - i - m ;

		<span class="hljs-keyword">while</span> ( r --&gt; q ) {

			w = a[j-<span class="hljs-number">1</span>] ;

			x = binarysearch( compare , a , i , i + m + q , w ) ;
			l = x[<span class="hljs-number">0</span>] + x[<span class="hljs-number">1</span>] ;

			s = j ;

			<span class="hljs-keyword">while</span> ( --s &gt; l ) {

				swap( a , s , s - <span class="hljs-number">1</span> ) ;

			}


		}

	} ;

	<span class="hljs-keyword">return</span> fordjohnson ;

} ;

exports._fordjohnson = _fordjohnson ;</div></div></div></div></body></html>